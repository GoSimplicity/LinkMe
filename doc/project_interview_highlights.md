# 项目面试亮点

## 用户模块

在用户模块的设计中，我采取了以下关键步骤来优化安全性、性能和用户体验：

1. **身份校验与令牌管理**：
    - **短Token（身份校验Token）**：
        - 用于用户身份验证，每次用户请求时在HTTP头中携带。
        - 具有较短的有效期，如5分钟，以增强安全性。
        - 存储在客户端，如浏览器Cookie。
    - **长Token（刷新Token）**：
        - 用于刷新短Token，确保用户持续登录状态。
        - 具有较长的有效期，如一周，减少用户重新登录的频率。
        - 存储在服务端，通常通过Redis等缓存服务实现。
2. **令牌生成与验证**：
    - 使用JWT（JSON Web Tokens）技术生成和验证Token。
    - 短Token和长Token都包含用户ID、SSID（会话ID）等信息。
    - 短Token包含用户代理和内容类型等信息，用于追踪用户行为。
3. **安全性与性能**：
    - 短Token的有效期短，即使被泄露，威胁窗口也较短。
    - 长Token在服务端存储，即使泄露，也不会直接暴露用户身份。
    - 减少了对数据库的直接访问，提高了性能。
4. **用户界面**：
    - 设计直观的用户登录和注册界面，简化用户操作。
    - 实现自动登录功能，使用户在刷新页面或重新加载时无需重新登录。
5. **数据同步**：
    - 实现Token的有效期管理，自动刷新短Token。
    - 确保长Token在用户会话结束时失效，以防止滥用。
6. **异常处理**：
    - 实现Token过期或无效时的错误处理，返回清晰的错误信息。
    - 监控Token的生成和使用情况，及时发现和处理异常。

## 帖子模块

在帖子模块的设计中，我采取了以下关键步骤来优化性能和用户体验：

1. **数据库选择**：
    - 线上库（`Posts`）：使用MongoDB存储已发布的帖子，利用其灵活的文档模型和高效的读写性能
    - 制作库（`Drafts`）：使用MySQL存储未发布的帖子，利用其支持事务和严格数据一致性的特点
2. **数据同步**：
    - 当用户发布帖子时，系统将帖子从制作库同步到线上库，确保帖子的状态和内容准确无误
3. **查询逻辑**：
    - 已发布的帖子通过线上库查询，提供快速、高效的访问
    - 未发布的帖子通过制作库查询，仅允许帖子的所有者访问
4. **用户界面**：
    - 设计用户友好的界面，包括“保存草稿”和“发布”按钮，便于用户管理帖子
5. **安全性**：
    - 实现严格的权限控制，确保只有帖子的所有者可以访问和编辑未发布的帖子
6. **性能优化**：
    - 考虑使用缓存机制来提高查询效率，同时确保同步操作不会影响系统性能

为什么选择分开存储(MongoDB/MySQL)

1. **技术优势**:
    - MongoDB
        - 适合存储和查询文档型数据，如帖子的内容和评论
        - 提供灵活的查询能力，支持复杂的聚合操作
        - 适用于读写操作频繁的场景
    - MySQL
        - 适合存储结构化数据，如用户信息和帖子元数据
        - 支持事务处理，确保数据一致性
        - 提供丰富的数据管理和备份工具
2. **安全性**
    - 可以根据不同的安全需求，对两个数据库实施不同的访问控制策略